<h1 align="center">Magician的设计理念</h1>

## 问题阐述

这个问题，需要分两部分来说，一部分是web组件，还有一部分是区块链组件，因为这两块的开发动机是不一样的

### 首先说说web组件的部分

开发这一套组件的动机是基于一个主观的原因，客观角度来看，每个框架都有它的道理在里面，但是我在这要表达的仅仅是我个人的喜好，希望大家不要在较真哦。

因为我懒，我不喜欢去学习框架，我觉得很烦，规范多，配置多，功能还多，需要花不少时间去学习，而且学的还只是这一个框架的用法，对自己的技术提升并没有什么帮助，最多就是在找工作的时候 跟公司的 技术栈更匹配一些而已。

还有ORM框架（JPA，Hibernate之类的，不包含Mybatis），我到现在都没发现脱离SQL之后的好处在哪，变的太不灵活了，当然了 这也是我个人的主观想法，大家别当真，我先说说我平时惯用的开发流程：

- 根据需求 在navicat或者其他工具里写好sql，然后跑几遍看看，如果没问题就拷贝到Java项目中，完美解决。

***而ORM的流程只能这样（它支持sql，但不是主流）***

- 根据需求 在navicat或者其他工具 里 写好sql，然后跑几遍看看，如果没问题就用代码将这条sql的逻辑再写一次

***或者是这样***

- 根据需求，直接用代码实现，用不是sql的办法 去 思考怎么查询数据库

在我个人的思维里，这种做法有点反人类，操作数据库用sql是最方便的方式，写sql也不麻烦，写完还能马上测试，测完直接拷贝到项目里就好了，为什么要用代码来实现呢？ 写完还得起单元测试，太慢了。

### 再来说一说区块链组件

我自己在开发的过程中遇到过两个棘手的问题，一个是扫块，还有一个是调用智能合约，未来可能还会遇到更多问题，今天暂时先说这两个。

***1. 扫块的问题***

扫块这个动作如果单独看没什么问题，但如果结合业务需求就会变的有点麻烦，因为扫块一般不是仅仅将交易查出来入库这么简单，而是根据交易来判断 数据库里的某些数据的状态甚至是业务字段，是否应该修改，以及修改成什么值。

所以，筛选交易记录就是一个比较麻烦的工作量，你可能需要根据from，to，value，甚至是解析inputData去筛选。

还有，因为扫块的目的是为了将链上的状态或者数据同步到数据库，所以需要不停的去扫，由此引发几个问题：
1. 如果已经扫到最高的块高了，怎么处理？
2. 扫块跟筛选 是否应该放到两个线程，互不影响？
3. 是否应该在多个节点上轮询扫，而不是盯着一个节点”祸害“？
4. 如果同一个项目，要扫描多条链怎么办？
5. 如果需要下掉一个监听条件，怎么做到不影响别的逻辑？

***2. 调用智能合约的问题***

因为Java不像JS这种语言，可以随时随地动态生成代码，所以在调用智能合约这方面就有点麻烦：

1. 虽然Web3j提供了代码生成器，但是需要动手去生成，会消耗精力
2. 不采用生成代码的方式，会有一点麻烦，要写很多行代码。

所以，它的问题是 需要寻找到一种折中的方式。

## 我的设想

### Web组件

既然我讨厌框架，那就很好解决啦，不用框架不就好了，全部手写！ 这应该是最简单粗暴的解决方案了，但是如果我真这么做了，那也应该累死了，不是因为工作量太大累死的，而是写了太多重复的代码累死的。

所以，问题已经很明显了，我们只需要避免重复就好了，先简单分析下这些场景：

***1. Http服务***

我们要的其实非常简单，客户端发送参数，服务端能收到，服务端响应结果，客户端能收到，就这么简单，那我们是不是可以直接用NIO写一个类似的功能呢？ 当然可以了，问题就在于 如果我们每次写新项目 都要用NIO实现一次Http，是不是会很累？

所以，我们可以把这部分代码封装掉，封装出来的结果就是一个 只包含必要功能的jar包，理论上体积是最小的

***2. MVC***

我们要的也很简单，一个请求过来，可以被转发到指定的方法上，在方法里可以获取参数，可以响应结果。所以，我们只需要有一个小小的工具，可以来实现分发就好了。

***2. 数据库***

- sql传进去，List出来，返回的结果最好是实体对象
- 支持事务
- 实体类进去，数据 + 1

我们是不是只需要在JDBC上面 简单的套一层壳就好了？

### 区块链工具

***1. 扫块的问题***

***2. 调用智能合约的问题***

## 已经实现的成果

## 未来的规划

